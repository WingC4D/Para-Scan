# üõ°Ô∏è Detection Notes ‚Äî ParaScan

This document outlines expected behaviors generated by ParaScan and provides basic detection approaches for blue team or incident response analysts.

---

## üîç Simulated Behaviors

| Module | Description |
|--------|-------------|
| DHCP Mapper | Sends a broadcast DHCPDISCOVER to elicit DHCPOFFER replies |
| SYN Scanner | Sends SYNs with spoofed source IPs and TCP headers designed to blend in |
| Packet Analyzer | Logs SYN-ACK or RST replies for port status mapping |
| TCP Profile Mode (planned) | Simulates complete TCP conversations using timing + flag templates |
| DNS Responder (planned) | Replies to internal DNS queries with attacker-controlled IPs |
| MAC Spoofing (planned) | Creates Ethernet frames with spoofed MACs to impersonate internal devices |

---

## üìå Detection Summary

### üõ∞Ô∏è DHCP Mapping

- Monitor for devices sending DHCPDISCOVER without completing the full lease process.
- Alert on frequent DISCOVERs from MACs not matching known hosts.
- Correlate MAC-to-IP changes with DHCP server logs.

---

### üß† TCP SYN Scanner

- SYN packets that do not complete a 3-way handshake.
- TTL/window size inconsistencies from a single IP.
- Outbound SYNs using IPs assigned to other known systems (spoofing).
- Irregular timing or low-rate scanning may bypass threshold-based IDS.

---

### üé≠ TCP Profile Emulation

- TCP flag/order matching legitimate stacks, but without corresponding service activity.
- Frequent switching of behavior (e.g., SYNs that resemble Windows and Linux stacks from the same IP).
- Use passive fingerprinting (`p0f`, Suricata flow analysis) to detect anomalies.

---

### üß¨ DNS Responder (Planned)

- Unauthorized devices replying to DNS queries.
- DNS responses from IPs that do not match network DNS assignments.
- Internal names resolving to non-routable or attacker-controlled subnets.

---

### üéØ MAC Spoofing (Planned)

- ARP tables showing multiple MACs for the same IP.
- Device responding to DHCP/DNS/ARP with a MAC that doesn‚Äôt match historical logs.
- Unusual MAC vendors in high-trust VLANs (e.g., printer vendor MAC on a user subnet).

---

## üîé Tools

| Tool | Usage |
|------|-------|
| Suricata/Snort | Detect unusual SYN rates, spoofed IPs, and invalid MAC/IP combos |
| Wireshark | TTL/window/flag sequence anomalies |
| DHCP server logs | MAC/IP lease tracking |
| ARP cache/dumps | Conflict detection |
| EDR (Linux audit, Sysmon) | Monitor raw socket access, DNS hijack attempts |

---

## ‚úÖ Summary

ParaScan is intended as a training and analysis tool. It replicates attacker behavior commonly used in internal recon and stealth mapping, while optionally enabling detection logic to help defenders build response playbooks and alert rules.
